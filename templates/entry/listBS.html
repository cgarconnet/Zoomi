{% extends "base/theme.html" %}
{% load sitegate %}
{% load staticfiles %}


{% block animation %}
{% endblock %}

{% block content %}

<!-- We load then 2 defaults forms sitegate_signin_form and sitegate_signup_form
 -->

<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
<!-- <script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script> for sortable UI -->


<link rel="stylesheet" href="{% static "css/zoomi.css" %}">
<script src="{% static "js/zoomi.js" %}"></script>

<script>

$(document).ready(function () {

// Special script required here because I use Django parenthesis

        $(function() {
        $( "#todo_list_BS" ).sortable({
          handle: ".selector",
          placeholder: "ui-state-highlight",
          stop: function (event, ui) {


          // then we post the context to save the sorting
            var serial = $('#todo_list_BS').sortable('serialize');
            console.log(serial);
            $.ajax({
//            url: "{{ index.get_index_url }}",
              url: "{% url 'index' %}",
              type: "post",
              data: { 'content': serial, 'csrfmiddlewaretoken' : '{{ csrf_token }}' } 
            });

          }
        });
        $( "#todo_list_BS" ).disableSelection();
        });

});

</script>

<section id="services">
	<div class="container">
		<div class="row ">
			<div class="col-lg-12 text-center">



						<ul id="todo_list_BS">
						   	{% for objects in object_list %}						

								<li id="entry_{{ objects.id }}" class="list-group-item {% if objects.section == 1 %}active{% endif %}">
								  	<div class="row">

										<div class="col-xs-1 col-sm-1 col-md-1">
								   			<span class="{% if objects.section == 0 %}glyphicon glyphicon-ok entrycheckmark{% endif %} {% if objects.done == 1 %}completed{% else %}todo{% endif %}" onclick="EntryComplete({{ objects.id }})"> </span>
								   		</div>
								   		<div class="col-xs-8 col-sm-6 col-md-6 text-left">
								   			<p class="list-group-item-text">{{ objects }}</p>
								   		</div>
								   		<div class="hidden-xs col-sm-3 col-md-3 text-right">
								   			<p class="list-group-item-text">
										        {% if objects.duedate %}
										            <span class="
										                {% if objects.duedate|timesince >= "1 min" %}
										                overdue
										                {% endif %}
										                ">
										                {{ objects.duedate }}
										            </span>
										        {% endif %}
								   			</p>
									    </div>
								   		<div class="col-xs-1 col-sm-1 col-md-1 text-right">
								   			<button type="button" class="btn btn-link" data-toggle="modal" data-toload="{{ objects.update_modal_entry_url }}" data-backdrop="true" data-target="#editModal">
												<span class="glyphicon glyphicon-edit editor">
								   			</button>
									    </div>
								   		<div class="hidden-xs col-sm-1 col-md-1 text-right">
								   			<span class="glyphicon glyphicon-menu-hamburger selector">
									    </div>

									    

									</div>
								</li>

							{% endfor %}
						</ul>
			</div>
		</div>
	</div>

</section>


<!-- My test modal -->

<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      	<div class="modal-body" id="editModalContent">
      		<!-- My content will go there -->
		</div>
<!--       <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
 -->    </div>
  </div>
</div>

{% endblock %}

{% block footer %}
	<footer class="navbar navbar-default navbar-fixed-bottom">
		<div class="container">
			{% include 'entry/create.html' %}
		</div>
	</footer>
{% endblock %}
